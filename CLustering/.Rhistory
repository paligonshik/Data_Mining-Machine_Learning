df <- data.frame(a, b)
a <- c(2,2,8,0,7,0,1,7,3,9)
df <- data.frame(a, b)
df
df
a <- c(2,2,8,0,7,0,1,7,3,9)
b <- c(5,3,3,4,5,7,5,3,7,5)
df <- data.frame(a, b)
df
plot(a,b)
## [1] 1 1 1 1 2 1
col = rep("red", 10)
col
n=10
clusters = sample(1:2, 10, replace = T)
clusters
col = rep("red", 10)
col[clusters == 2] = "blue"
pch = rep(16, 10)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
a <- c(2,2,8,0,7,0,1,7,3,9)
b <- c(5,3,3,4,5,7,5,3,7,5)
df <- data.frame(a, b)
plot(a,b)
clusters = sample(1:2, n, replace = T)
## [1] 1 1 1 1 2 1
col = rep("red", 10)
clusters = sample(1:2, n, replace = T)
n=10
clusters = sample(1:2, n, replace = T)
clusters
## [1] 1 1 1 1 2 1
col = rep("red", 10)
clusters
col = rep("red", 10)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(X, col = col, pch = pch)
plot(df, col = col, pch = pch)
centroids = aggregate(X, list(Cluster = clusters), mean)
centroids = aggregate(df, list(Cluster = clusters), mean)
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
centroids
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
points(centroids[1,2:3], col = "red", pch = 8)
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
library(class)
clusters = knn(centroids[,2:3], df, factor(centroids[,1]))
clusters
col = rep("red", n)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(X, col = col, pch = pch)
library(class)
clusters = knn(centroids[,2:3], df, factor(centroids[,1]))
clusters
col = rep("red", n)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
centroids = aggregate(df, list(Cluster = clusters), mean)
centroids
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
clusters = knn(centroids[,2:3], df, factor(centroids[,1]))
clusters
## [1] 1 1 1 2 2 2
## Levels: 1 2
centroids = aggregate(df, list(Cluster = clusters), mean)
centroids
col = rep("red", n)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
library(ggplot2)
library(dplyr)
library(knitr)
library(cluster) #for computing fuzzy clustering
library(factoextra)#for visualizing clusters
data("iris")
iris.scaled <- scale(iris[, -5])
obj<-cluster::fanny(iris.scaled,k=3)
head(obj$membership)
fviz_cluster(obj, ellipse.type = "norm")
n=10
a <- c(2,2,8,0,7,0,1,7,3,9)
b <- c(5,3,3,4,5,7,5,3,7,5)
df <- data.frame(a, b)
plot(a,b)
clusters = sample(1:2, n, replace = T)
clusters
col = rep("red", 10)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
centroids = aggregate(df, list(Cluster = clusters), mean)
centroids
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
library(class)
clusters = knn(centroids[,2:3], df, factor(centroids[,1]))
clusters
col = rep("red", n)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
centroids = aggregate(df, list(Cluster = clusters), mean)
centroids
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
clusters = knn(centroids[,2:3], df, factor(centroids[,1]))
clusters
centroids = aggregate(df, list(Cluster = clusters), mean)
centroids
col = rep("red", n)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
load("WVS.rds")
load("WVS.rds")
load("WVS")
load("WVS.rda")
load("WVS.rds")
readRDS("WVS.rds")
data<-readRDS("WVS.rds")
str(data)
head(data)
index(data)
source("WVS.rds")
load("WVS.rds")
data<-readRDS("WVS.rds")
head(data)
head(data)
load("WVS")
load("WVS.rds")
df<-load("WVS.rds")
source("WVS.rds")
WVS <- readRDS("C:/Users/Vazgen/Desktop/HW/R/Hw10_Vazgen/WVS.rds")
head(WVS)
view(data[1,])
View(data[1,])
View(data[1:4,])
table(data$V1)
table(data$V2)
table
table(data$V2A)
table(data$V2)
table(data$V2)==table(data$V2A)
table(data$V2)==table(data$V2A)
table(data$V2A)
table(data$V3)
colnames(data)
data<-data[ , -which(names(data) %in% c("V1","V2A","V3"))]
head(data)
dim(data)
data<-data[ , which(names(data) %in% c("V1","V2A","V3"))]
data<-readRDS("WVS.rds")
data<-data[ , which(names(data) %in% c("V1","V2A","V3"))]
head(data)
data<-readRDS("WVS.rds")
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27","V28"))]
head(data)
data<-readRDS("WVS.rds")
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27"))]
colnames(data)<-c("Country","family","friend","leisure","politics","work","religion","happiness","sport","art")
dim(data)
head(data)
library(dplyr)
data %>%
group_by(fata) %>%
summarize(mean())
data %>%
group_by(data) %>%
summarize(mean())
data %>%
group_by(Country) %>%
summarize(mean())
data %>%
group_by(Country) %>%
summarize(n())
data %>%
group_by(Country) %>%
summarize(mean)
data %>%
group_by(Country) %>%
summarize(mean())
data %>%
group_by(Country) %>%
summarise_all("mean")
dim(df)
df<-data %>%
group_by(Country) %>%
summarise_all("mean")
dim(df)
data<-readRDS("WVS.rds")
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27"))]
dim(data)
colnames(data)<-c("Country","family","friend","leisure","politics","work","religion","happiness","sport","art")
df<-data %>%
group_by(Country) %>%
summarise_all("mean")
dim(df)
table(df)
table(df$Country)
df%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
df
setnames(df$Country, old=c(31,51), new=c("new_name", "another_new_name"))
library(data.table)
setnames(df$Country, old=c(31,51), new=c("new_name", "another_new_name"))
df$Country<-factor(df$Country)
levels(df$Country)
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
df$Country
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27"))]
data<-readRDS("WVS.rds")
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27"))]
colnames(data)<-c("Country","family","friend","leisure","politics","work","religion","happiness","sport","art")
dim(data)
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
df$Country
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
unique(df)
unique(df$Country)
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
unique(df$Country)
unique(df$Country)
data[data$Country==498,]
df<-data %>%
group_by(Country) %>%
summarise_all("mean")#%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
unique(df)
unique(df$Country)
z<-df%>%filter(Country %in% c(31,56,398,417,51,498,643,860,762,392,840,356,826,250))
unique(df$Country)
unique(z$Country)
data<-readRDS("WVS.rds")
levels(df$Country)<-
unique(data$V2A)
levels(df$Country)<-
unique(data$V2A)
unique(data$V2A)
unique(z$Country)
data<-readRDS("WVS.rds")
data<-readRDS("WVS.rds")
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27"))]
colnames(data)<-c("Country","family","friend","leisure","politics","work","religion","happiness","sport","art")
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31, 51, 356, 392, 398, 417, 643, 840, 860,32,858))
union(df$Country)
unique(df$Country)
str(df)
df$Country<-factor(df$Country)
levels(df)
levels(df$Country)
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31, 51, 356, 392, 398, 417, 643, 840, 860,32,858,268,792))
df$Country<-factor(df$Country)
levels(df$Country)
levels(df$Country)
levels(df$Country)<-c("Azerbejan","Argentina","Armenia","Georgia","India","Japan","Kazaxstan","Kghrghrstan","Russia","Turkey","Usa","Urugvay","Uzbegstan")
head(df)
rownames(df)<-df$Country
head(df)
str(df)
row.names(df)
colnames(df)
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31, 51, 356, 392, 398, 417, 643, 840, 860,32,858,268,792))
df$Country<-factor(df$Country)
levels(df$Country)<-c("Azerbejan","Argentina","Armenia","Georgia","India","Japan","Kazaxstan","Kghrghrstan","Russia","Turkey","Usa","Urugvay","Uzbegstan")
head(df)
head(df)
rownames(df)<-df$Country
head(df)
index1<-df[,!1]
index1
index1<-df[,2:]
index1<-df[,2:8]
index1
rownames(index1)
rownames(df)<-df$Country
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31, 51, 356, 392, 398, 417, 643, 840, 860,32,858,268,792))
df$Country<-factor(df$Country)
df$Country
df$Country<-c("Azerbejan","Argentina","Armenia","Georgia","India","Japan","Kazaxstan","Kghrghrstan","Russia","Turkey","Usa","Urugvay","Uzbegstan")
head(df)
rownames(df)<-df$Country
rownames(df)
df$Country<-NULL
rownames(df)
head(df)
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31, 51, 356, 392, 398, 417, 643, 840, 860,32,858,268,792))
df$Country<-c("Azerbejan","Argentina","Armenia","Georgia","India","Japan","Kazaxstan","Kghrghrstan","Russia","Turkey","Usa","Urugvay","Uzbegstan")
head(df)
index1<-df[,2:8]
rownames(index1)
df$Country<-NULL
d<-dist(df,method = "euclidian")
d
c1<-hclust((d,method="complete"))
c1<-hclust(d,method="complete")
plot(c1)
rownames(df)
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27"))]
colnames(data)<-c("Country","family","friend","leisure","politics","work","religion","happiness","sport","art")
head(df)
data<-readRDS("WVS.rds")
data<-readRDS("WVS.rds")
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27"))]
dim(data)
colnames(data)<-c("Country","family","friend","leisure","politics","work","religion","happiness","sport","art")
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31, 51, 356, 392, 398, 417, 643, 840, 860,32,858,268,792))
head(df)
rownames(df)<-df$Country
df$Country<-NULL
rownames(df)
df$Country<-NULL
d<-dist(df,method = "euclidian")
c1<-hclust(d,method="complete")
plot(c1)
rownames(df)
rownames(df)
rownames(df)<-df$Country
df$Country<-c("Azerbejan","Argentina","Armenia","Georgia","India","Japan","Kazaxstan","Kghrghrstan","Russia","Turkey","Usa","Urugvay","Uzbegstan")
rownames(df)<-df$Country
rownames(df)
df$Country<-NULL
rownames(df)
d<-dist(df,method = "euclidian")
c1<-hclust(d,method="complete")
plot(c1)
rownames(df)
library(dplyr)
library(ggplot2)
library(dplyr)
library(knitr)
library(cluster) #for computing fuzzy clustering
library(factoextra)#for visualizing clusters
data("iris")
iris.scaled <- scale(iris[, -5])
obj<-cluster::fanny(iris.scaled,k=3)
head(obj$membership)
fviz_cluster(obj, ellipse.type = "norm")
n=10
a <- c(2,2,8,0,7,0,1,7,3,9)
b <- c(5,3,3,4,5,7,5,3,7,5)
df <- data.frame(a, b)
plot(a,b)
clusters = sample(1:2, n, replace = T)
clusters
col = rep("red", 10)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
centroids = aggregate(df, list(Cluster = clusters), mean)
centroids
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
library(class)
clusters = knn(centroids[,2:3], df, factor(centroids[,1]))
clusters
col = rep("red", n)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
centroids = aggregate(df, list(Cluster = clusters), mean)
centroids
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
clusters = knn(centroids[,2:3], df, factor(centroids[,1]))
clusters
centroids = aggregate(df, list(Cluster = clusters), mean)
centroids
col = rep("red", n)
col[clusters == 2] = "blue"
pch = rep(16, n)
pch[clusters == 2] = 17
plot(df, col = col, pch = pch)
points(centroids[1,2:3], col = "red", pch = 8)
points(centroids[2,2:3], col = "blue", pch = 8)
data<-readRDS("WVS.rds")
data<-data[ , which(names(data) %in% c("V2","V4","V5","V6","V7","V8","V9","V10","V26","V27"))]
dim(data)
colnames(data)<-c("Country","family","friend","leisure","politics","work","religion","happiness","sport","art")
df<-data %>%
group_by(Country) %>%
summarise_all("mean")%>%filter(Country %in% c(31, 51, 356, 392, 398, 417, 643, 840, 860,32,858,268,792))
df$Country<-c("Azerbejan","Argentina","Armenia","Georgia","India","Japan","Kazaxstan","Kghrghrstan","Russia","Turkey","Usa","Urugvay","Uzbegstan")
head(df)
rownames(df)<-df$Country
df$Country<-NULL
rownames(df)
df$Country<-NULL
c1<-hclust(d,method="complete")
plot(c1)
d<-dist(df,method = "euclidian")
c1<-hclust(d,method="complete")
plot(c1)
c1$height
df
clust<=kmeans(df3)
clust<-kmeans(df3)
clust<-kmeans(df)
clust<-kmeans(matrix(df))
clust<-kmeans(matrix(df),3)
clust<-complete.cases(df)
kmeans(clust,3)
#clust<-
df[complete.cases(df),]
#clust<-
nor<-  df[complete.cases(df),]
kmeans(nor,3)
km<-kmeans(nor,3)
km$cluster
rownames(df)
plot(km)
fviz_cluster(km)
fviz_cluster(km,data=df)
library(factoextra)
fviz_nbclust(df,kmeans,method = "wss")
df2<-  df[complete.cases(df),]
km<-kmeans(df2,3)
km$centers
fviz_cluster(km,data=df2)
df2<-  df[complete.cases(df),]
km<-kmeans(df2,3)
km$centers
fviz_cluster(km,data=df)
df2<-  df[complete.cases(df),]
km<-kmeans(df2,4)
km$centers
fviz_cluster(km,data=df)
