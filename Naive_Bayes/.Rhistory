library(gtools)
HomeOwner<-c("Yes","No","No","Yes","No","No","Yes","No","No","No","Yes","Yes","Yes","No")
Marital_Status<-c("Single","Married","Single","Married","Divorced","Married","Divorced","Single","Married","Single","Divorced","Divorced","Married","Married")
Annul_Income<-c(125,100,70,120,150,60,220,85,75,90,180,200,250,50)
Annul_Income<-quantcut(Annul_Income,3,labels=c("low","medium","high"))
Default<-c("No","No","No","No","Yes","No","No","Yes","No","Yes","Yes","No","No","Yes")
table(Default)
addmargins(table(Default,HomeOwner))
addmargins(table(Default,Marital_Status))
addmargins(table(Default,Annul_Income))
P_defY_Homeyes<-1/6
P_defY_Marit_Sing<-2/4
P_defY_Inc_High<-2/5
P_defY<-5/14
h_yes<-prod(P_defY_Homeyes,P_defY_Marit_Sing,P_defY_Inc_High,P_defY)
P_defN_Homeyes<-5/6
P_defN_Marit_Sing<-2/4
P_defN_Inc_High<-3/5
P_defN<-9/14
h_no<-prod(P_defY_Homeyes,P_defY_Marit_Sing,P_defY_Inc_High,P_defY)
max(h_no,h_yes)
h_yes/sum(h_no,h_yes)+h_no/sum(h_no,h_yes)## indicates we calculated yes.
library(carData)
data("Wells")
head(Wells)
library(ggplot2)
library(gridExtra)
g1 = ggplot(data = Wells, aes(y = arsenic, x = switch,color = switch))+geom_boxplot()+
scale_x_discrete(labels= levels(Wells$switch) )+
stat_summary(fun.y = "mean",geom = 'point',col='red', shape=17, size=4)+
labs(title ="Arsenic by switch " ,color =  "switch",y='Arsenic',x="switch")+
theme(plot.title = element_text(hjust = 0.5))
g2 = ggplot(data = Wells, aes(y = distance, x = switch,color = switch))+geom_boxplot()+
scale_x_discrete(labels= levels(Wells$switch) )+
stat_summary(fun.y = "mean",geom = 'point',col='red', shape=17, size=4)+
labs(title ="Distance by switch " ,color =  "switch",y='Distance',x="switch")+
theme(plot.title = element_text(hjust = 0.5))
g3 = ggplot(data = Wells, aes(y = education, x = switch,color = switch))+geom_boxplot()+
scale_x_discrete(labels= levels(Wells$switch) )+
stat_summary(fun.y = "mean",geom = 'point',col='red', shape=17, size=4)+
labs(title ="Education by switch " ,color =  "switch",y='Education',x="switch")+
theme(plot.title = element_text(hjust = 0.5))
colnames(Wells)
g4=ggplot(Wells,aes(arsenic))+geom_density()
g4=ggplot(Wells,aes(arsenic))+geom_density()
g4
g4=ggplot(Wells,aes(arsenic))+geom_density()+facet_grid(~.switch)
g4
g4=ggplot(Wells,aes(arsenic))+geom_density()+facet_grid(.~switch)
g4
grid.arrange(g1, g2, g3,g4,nrow=2)
g3 = ggplot(data = Wells, aes(y = education, x = switch,color = switch))+geom_boxplot()+
scale_x_discrete(labels= levels(Wells$switch) )+
stat_summary(fun.y = "mean",geom = 'point',col='red', shape=17, size=4)+
labs(title ="Education by switch " ,color =  "switch",y='Education',x="switch")+
theme(plot.title = element_text(hjust = 0.5))
g4=ggplot(Wells,aes(arsenic))+geom_density()+facet_grid(.~switch)+ggtitle("Density of Distance by Switch")
grid.arrange(g1, g2, g3,g4,nrow=2)
model$tables$association
library(gtools)
HomeOwner<-c("Yes","No","No","Yes","No","No","Yes","No","No","No","Yes","Yes","Yes","No")
Marital_Status<-c("Single","Married","Single","Married","Divorced","Married","Divorced","Single","Married","Single","Divorced","Divorced","Married","Married")
Annul_Income<-c(125,100,70,120,150,60,220,85,75,90,180,200,250,50)
Annul_Income<-quantcut(Annul_Income,3,labels=c("low","medium","high"))
Default<-c("No","No","No","No","Yes","No","No","Yes","No","Yes","Yes","No","No","Yes")
table(Default)
addmargins(table(Default,HomeOwner))
addmargins(table(Default,Marital_Status))
addmargins(table(Default,Annul_Income))
P_defY_Homeyes<-1/6
P_defY_Marit_Sing<-2/4
P_defY_Inc_High<-2/5
P_defY<-5/14
h_yes<-prod(P_defY_Homeyes,P_defY_Marit_Sing,P_defY_Inc_High,P_defY)
P_defN_Homeyes<-5/6
P_defN_Marit_Sing<-2/4
P_defN_Inc_High<-3/5
P_defN<-9/14
h_no<-prod(P_defY_Homeyes,P_defY_Marit_Sing,P_defY_Inc_High,P_defY)
max(h_no,h_yes)
h_yes/sum(h_no,h_yes)+h_no/sum(h_no,h_yes)## indicates we calculated yes.
library(carData)
data("Wells")
head(Wells)
library(ggplot2)
library(gridExtra)
g1 = ggplot(data = Wells, aes(y = arsenic, x = switch,color = switch))+geom_boxplot()+
scale_x_discrete(labels= levels(Wells$switch) )+
stat_summary(fun.y = "mean",geom = 'point',col='red', shape=17, size=4)+
labs(title ="Arsenic by switch " ,color =  "switch",y='Arsenic',x="switch")+
theme(plot.title = element_text(hjust = 0.5))
g2 = ggplot(data = Wells, aes(y = distance, x = switch,color = switch))+geom_boxplot()+
scale_x_discrete(labels= levels(Wells$switch) )+
stat_summary(fun.y = "mean",geom = 'point',col='red', shape=17, size=4)+
labs(title ="Distance by switch " ,color =  "switch",y='Distance',x="switch")+
theme(plot.title = element_text(hjust = 0.5))
g3 = ggplot(data = Wells, aes(y = education, x = switch,color = switch))+geom_boxplot()+
scale_x_discrete(labels= levels(Wells$switch) )+
stat_summary(fun.y = "mean",geom = 'point',col='red', shape=17, size=4)+
labs(title ="Education by switch " ,color =  "switch",y='Education',x="switch")+
theme(plot.title = element_text(hjust = 0.5))
g4=ggplot(Wells,aes(arsenic))+geom_density()+facet_grid(.~switch)+ggtitle("Density of Distance by Switch")
grid.arrange(g1, g2, g3,g4,nrow=2)
colnames(Wells)
library(e1071)
library(caret)
set.seed(1)
index<- createDataPartition(Wells$switch, p=0.8, list=F)
train<-Wells[index,]
test<-Wells[-index,]
model<-naiveBayes(switch~., data=train, laplace = 1)
names(model)
model$apriori
p_yes<-model$apriori[2]/sum(model$apriori)
p_no<-model$apriori[1]/sum(model$apriori)
print(paste("Prior probabity for switch yes is",p_yes))
model$tables$association
HomeOwner<-c("Yes","No","No","Yes","No","No","Yes","No","No","No","Yes","Yes","Yes","No")
Marital_Status<-c("Single","Married","Single","Married","Divorced","Married","Divorced","Single","Married","Single","Divorced","Divorced","Married","Married")
Annul_Income<-c(125,100,70,120,150,60,220,85,75,90,180,200,250,50)
Annul_Income<-quantcut(Annul_Income,3,labels=c("low","medium","high"))
library(gtools)
HomeOwner<-c("Yes","No","No","Yes","No","No","Yes","No","No","No","Yes","Yes","Yes","No")
Marital_Status<-c("Single","Married","Single","Married","Divorced","Married","Divorced","Single","Married","Single","Divorced","Divorced","Married","Married")
Annul_Income<-c(125,100,70,120,150,60,220,85,75,90,180,200,250,50)
Annul_Income<-quantcut(Annul_Income,3,labels=c("low","medium","high"))
Default<-c("No","No","No","No","Yes","No","No","Yes","No","Yes","Yes","No","No","Yes")
table(Default)
addmargins(table(Default,HomeOwner))
addmargins(table(Default,Marital_Status))
addmargins(table(Default,Annul_Income))
P_defY_Homeyes<-1/6
P_defY_Marit_Sing<-2/4
P_defY_Inc_High<-2/5
P_defY<-5/14
h_yes<-prod(P_defY_Homeyes,P_defY_Marit_Sing,P_defY_Inc_High,P_defY)
P_defN_Homeyes<-5/6
P_defN_Marit_Sing<-2/4
P_defN_Inc_High<-3/5
P_defN<-9/14
h_no<-prod(P_defN_Homeyes,P_defN_Marit_Sing,P_defN_Inc_High,P_defN)
max(h_no,h_yes)
h_yes/sum(h_no,h_yes)+h_no/sum(h_no,h_yes)## indicates we calculated yes.
max(h_no,h_yes)
h_yes
h_no
max(h_no,h_yes)
addmargins(table(Default,HomeOwner))
library(gtools)
HomeOwner<-c("Yes","No","No","Yes","No","No","Yes","No","No","No","Yes","Yes","Yes","No")
Marital_Status<-c("Single","Married","Single","Married","Divorced","Married","Divorced","Single","Married","Single","Divorced","Divorced","Married","Married")
Annul_Income<-c(125,100,70,120,150,60,220,85,75,90,180,200,250,50)
Annul_Income<-quantcut(Annul_Income,3,labels=c("low","medium","high"))
Default<-c("No","No","No","No","Yes","No","No","Yes","No","Yes","Yes","No","No","Yes")
table(Default)
addmargins(table(Default,HomeOwner))
addmargins(table(Default,HomeOwner))
addmargins(table(Default,Marital_Status))
addmargins(table(Default,Annul_Income))
addmargins(table(Default,HomeOwner))
addmargins(table(Default,Marital_Status))
addmargins(table(Default,Annul_Income))
addmargins(table(Default,HomeOwner))
addmargins(table(Default,Marital_Status))
addmargins(table(Default,Annul_Income))
P_defY_Homeyes<-1/5
P_defY_Marit_Sing<-2/5
P_defY_Inc_High<-2/5
P_defY<-5/14
h_yes<-prod(P_defY_Homeyes,P_defY_Marit_Sing,P_defY_Inc_High,P_defY)
P_defN_Homeyes<-5/9
P_defN_Marit_Sing<-2/9
P_defN_Inc_High<-3/9
P_defN<-9/14
h_no<-prod(P_defN_Homeyes,P_defN_Marit_Sing,P_defN_Inc_High,P_defN)
max(h_no,h_yes)
h_yes/sum(h_no,h_yes)+h_no/sum(h_no,h_yes)
h_no
h_yes
library(caret)
library(ROCR)
library(e1071)
Income=c(125,100,70,120,150,60,220,85,75,90,180,200,250,50)
Howner=c("Yes","No","No","Yes","No","No","Yes","No","No","No","Yes","Yes","Yes","No")
Default=c("No","No","No","No","Yes","No","No","Yes","No","Yes","Yes","No","No","Yes")
Mstatus=c("Single","Married","Single","Married","Divorced","Married","Divorced","Single","Married","Single","Divorced","Divorced","Married","Married")
income_no=c(60,70,75,100,120,125,200,220,250)
mean(income_no)
sd(income_no)
income_yes=c(50,85,90,150,180)
mean(income_yes)
sd(income_yes)
# P(Hone Owner: Yes, Marital Status: Single, Annual Income: 158)
P_income_no=pnorm(158,135.556,70.42036)
P_income_yes=pnorm(158,111,52.72571)
P_income_yes
P_income_no
table(Default)
addmargins(table(Howner,Default))
addmargins(table(Mstatus,Default))
P_default_yes<-5/14
P_default_no<-9/14
P_how_yes<-1/5
P_how_no<-5/9
p_mst_single_yes<-2/5
p_mst_single_no<-2/9
p_mst_married_yes<-1/5
p_mst_married_no<-5/9
p_mst_divorced_yes<-2/5
p_mst_divorced_no<-2/9
P_h_yes=prod(P_how_yes,p_mst_single_yes,P_income_yes,P_default_yes)
P_h_yes
P_h_no=prod(P_how_no,p_mst_single_no,P_income_no,P_default_no)
P_h_no
max(P_h_no,P_h_yes)
# so in this case we would predict no
library(sm)
install.packages("sm")
library(dplyr)
library(ggplot2)
data<-read.csv("final2.csv")
library(dplyr)
library(ggplot2)
data<-read.csv("final2.csv")
